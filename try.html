<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html;charset=UTF-8" />
  <title>Try CoffeeScript</title>
  <link rel="stylesheet" type="text/css" href="documentation/css/docs.css" />
  <link rel="stylesheet" type="text/css" href="documentation/css/idle.css" />
  <link rel="shortcut icon" href="documentation/images/favicon.ico" />
  <style>
    .navigation.try {
      border-left-width: 1px;
    }
  </style>
</head>
<body>
  <div id="fadeout"></div>

  <div id="flybar">
    <a id="logo" href="./"> </a>
    <div class="navigation try active">
      <div class="button">
        Try CoffeeScript
        <div class="repl_bridge"></div>
      </div>
      <div class="contents repl_wrapper">
        <div class="code">
          <div class="screenshadow tl"></div>
          <div class="screenshadow tr"></div>
          <div class="screenshadow bl"></div>
          <div class="screenshadow br"></div>
          <div id="repl_source_wrap">
            <textarea id="repl_source" rows="100"># Enter CoffeeScript code here and it will be
# translated to JavaScript in real-time. You
# can run the code by pressing the Run button
# to the right or command-R.

alert "Hello CoffeeScript!"
</textarea>
          </div>
          <div id="repl_results_wrap"><pre id="repl_results"></pre></div>
          <div class="minibutton dark run">Run</div>
          <br class="clear" />
        </div>
      </div>
    </div>
    <div id="error" style="display:none;"></div>
  </div>

  <script type="text/coffeescript">

    # Set up the compilation function, to run when you stop typing.
    compileSource = ->
      source = $('#repl_source').val()
      window.compiledJS = ''
      try
        window.compiledJS = CoffeeScript.compile source, bare: on
        el = $('#repl_results')[0]
        if el.innerText
          el.innerText = window.compiledJS
        else
          $(el).text window.compiledJS
        $('#error').hide()
      catch error
        $('#error').text(error.message).show()

    # Listen for key and mouse presses and and recompile.
    $('#repl_source').keyup -> compileSource()
    $('#repl_source').mouseup -> compileSource()

    runCompiledSource = ->
      try
        eval window.compiledJS
      catch error then alert error

    # Eval the compiled js.
    $('.minibutton.run').click runCompiledSource

    # Load the console with a string of CoffeeScript.
    window.loadConsole = (coffee) ->
      $('#repl_source').val coffee
      compileSource()
      $('.navigation.try').addClass('active')
      false

    $(window).keydown (e) ->
      console.log 
      code = e.charCode or e.keyCode
      if e.which == 82 and e.ctrlKey
        compileSource()
        runCompiledSource()

    $("#repl_source").focus().each -> this.selectionStart = $(this).text().length

    compileSource()

  </script>

  <script src="documentation/vendor/jquery-1.4.2.js"></script>
  <script src="extras/coffee-script.js"></script>
</body>
</html>
